function explore(){clearNodeClick();var e=d3.selectAll("div#intro, h1#dynamic");e.transition().style("opacity",0),e.transition().delay(500).style("display","none");var t=d3.select("div#sidebar");t.style("display","block"),t.transition().style("left","0%")}function getDate(e){var t="";return e.value.hasOwnProperty("date")&&(t=e.value.date),e.value.hasOwnProperty("bdate")&&(t="b. "+e.value.bdate),e.value.hasOwnProperty("ddate")&&(t+=" d. "+e.value.ddate),t=""==t?"":t+"<br/>"}function formatRank(e){return"Rank: "+Math.round(100*percentileRank(e.value.rank))/100+"/100"}function getLocation(e){return e.value.hasOwnProperty("location")?e.value.location+"<br/>":""}function showDeets(){return function(e){var t=e.value.title,n=getLocation(e),a=getDate(e),r=formatRank(e),l=50;d3.select(this).transition().attrs({r:circleSize(4)});var i=d3.select("div#chart").append("div").attrs({class:"nodeDeets card"}).styles({left:function(){return e.x>width/2?e.x-25-240+"px":e.x+25+"px"},top:e.y-50+"px",opacity:0});e.value.hasOwnProperty("image")&&null!=e.value.image&&i.append("div").classed("imgBox",!0).append("img").attrs({src:e.value.image,class:"svgHoverImg"}),i.append("p").text(t).append("span").classed("details",!0).html(" <br/> "+r+" <br/> "+n+a),i.transition().style("opacity",1)}}function circleSize(e){return function(t){return"Dada"==t.id?5+e:2*Math.ceil(100*+t.value.rank)+e}}function hideDeets(){return function(e){d3.select("div.nodeDeets").remove(),d3.select(this).transition().attrs({r:circleSize(0)})}}function toggler(){return function(e){var t=d3.select("div.toggle.g"+e.value),n=d3.select("svg").selectAll("circle.g"+e.value);t.classed("clicked")?(t.classed("clicked",!1),n.classed("toggled",!1)):(t.classed("clicked",!0),n.classed("toggled "+colorStrArr[e.value%8],!0))}}var colorStrArr=["lblu","oran","tgol","brow","blue","purp","ttea","gree","dbro","dblu"],svg=d3.select("svg");width=+svg.attr("width"),height=+svg.attr("height");var zg=svg.append("g"),slider=document.getElementById("slider-connect"),percentileRank=d3.scaleLinear().range([75,100]).domain([.001468,.114607]);d3.json("data/forceChart-d2fullSet.json",function(e,t){function n(e,n){var a=e.selectAll("div.article").data(t.nodes.filter(function(e){return e.value.distance==n})).enter().append("div").attrs({class:"article card",id:function(e){return"a_"+e.id}}),r=a.filter(function(e){return e.value.hasOwnProperty("image")&&null!=e.value.image}).append("div").classed("imgBox",!0).append("img").attrs({src:function(e){return e.value.image},class:"articleImg"}),l=a.append("p").classed("articleTitle",!0).text(function(e){return e.value.title}),i=a.append("p").classed("textLite",!0).html(function(e){var t=getDate(e),n=e.value.hasOwnProperty("location")?e.value.location+"<br/>":"";return"United States of America"==n&&(n="USA"),formatRank(e)+"<br/>"+n+t}),s=a.append("a").attrs({href:function(e){return"https://en.wikipedia.org/wiki/"+e.url},target:"new",class:"wiki"}).text("Wiki")}function a(e){loadMessage=d3.select("div.loadMessage"),loadMessage.transition(300).style("opacity",0),loadMessage.text(e),loadMessage.transition(300).style("opacity",1)}function r(e){var t=e.progress;.5==t?a("drawing chart..."):.75==t&&a("gadji beri bimba-ing...")}function l(e){var t=e.nodes,n=e.links;d3.select("div.loader").style("display","none"),d3.select("div.loadMessage").style("display","none");var a=zg.append("g").attr("class","links").selectAll("line").data(n).enter().append("line").attrs({x1:function(e){return e.source.x},y1:function(e){return e.source.y},x2:function(e){return e.target.x},y2:function(e){return e.target.y},class:function(e){return e.source.id+" "+e.target.id}}),r=zg.append("g").attr("class","nodes").selectAll("circle").data(t).enter().append("circle").attrs({r:circleSize(0),cx:function(e){return e.x},cy:function(e){return e.y},class:function(e){var t="";for(var n in e.value.group)t=t+" g"+e.value.group[n];return t},id:function(e){return e.id}}).on("mouseover",showDeets()).on("mouseout",hideDeets()).on("click",nodeClick()),l=d3.select("#titleList"),i=document.getElementById("search");l.selectAll("option").data(p).enter().append("option").attr("value",function(e){return e}),new Awesomplete(i,{list:"#titleList",minChars:3,maxItems:10}),document.getElementById("search").addEventListener("awesomplete-selectcomplete",function(){var e=p.indexOf(this.value),t=document.createEvent("HTMLEvents");t.initEvent("click",!0,!1),document.getElementById(u[e]).dispatchEvent(t)}),d3.selectAll("#intro, h1#dynamic").transition().style("opacity",1)}if(e)throw e;var i=d3.select("#catBox").selectAll("div.toggle").data(t.groupKey).enter().append("div").attr("class",function(e){return"toggle g"+e.value}).text(function(e){return e.key});i.append("input").attrs({class:"tgl tgl-light",id:function(e){return"g"+e.value},type:"checkbox"}).on("mouseup",toggler()),i.append("label").attrs({class:function(e){return"tgl-btn tgl-"+colorStrArr[e.value%8]},for:function(e){return"g"+e.value}}).on("mouseup",toggler());var s=d3.select("#row_d2");n(d3.select("#row_d1"),1),n(s,2);var o=t.links,c=t.nodes,d=new Worker("js/worker.js"),u=[],p=[];for(var g in c)u.push(c[g].id),p.push(c[g].value.title);d.postMessage({nodes:c,links:o}),d.onmessage=function(e){switch(e.data.type){case"tick":return r(e.data);case"end":return l(e.data)}}});